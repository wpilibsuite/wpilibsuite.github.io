<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WPILibC++: frc::SwerveDrivePoseEstimator&lt; NumModules &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="wpilib-128.png"/></td>
  <td id="projectalign">
   <div id="projectname">WPILibC++<span id="projectnumber">&#160;2023.1.1-beta-4-23-g5804d8f</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classfrc_1_1_swerve_drive_pose_estimator.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="classfrc_1_1_swerve_drive_pose_estimator-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">frc::SwerveDrivePoseEstimator&lt; NumModules &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This class wraps an Unscented Kalman Filter to fuse latency-compensated vision measurements with swerve drive encoder velocity measurements.  
 <a href="classfrc_1_1_swerve_drive_pose_estimator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_swerve_drive_pose_estimator_8h_source.html">frc/estimator/SwerveDrivePoseEstimator.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a897055b71e6be4167bef1c47db5f0254"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a897055b71e6be4167bef1c47db5f0254">SwerveDrivePoseEstimator</a> (const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;gyroAngle, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_position.html">SwerveModulePosition</a>, NumModules &gt; &amp;modulePositions, const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;initialPose, <a class="el" href="classfrc_1_1_swerve_drive_kinematics.html">SwerveDriveKinematics</a>&lt; NumModules &gt; &amp;kinematics, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#ac8964f855367a4f027a26d871f13965b">States</a> &gt; &amp;stateStdDevs, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a9142b8f6585f7102eaffceaba1df8c0d">Outputs</a> &gt; &amp;localMeasurementStdDevs, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;visionMeasurementStdDevs, units::second_t nominalDt=20_ms)</td></tr>
<tr class="memdesc:a897055b71e6be4167bef1c47db5f0254"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html" title="This class wraps an Unscented Kalman Filter to fuse latency-compensated vision measurements with swer...">SwerveDrivePoseEstimator</a>.  <a href="classfrc_1_1_swerve_drive_pose_estimator.html#a897055b71e6be4167bef1c47db5f0254">More...</a><br /></td></tr>
<tr class="separator:a897055b71e6be4167bef1c47db5f0254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d9c637e4ec9b0a7d5f74f7410ad80b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a5d9c637e4ec9b0a7d5f74f7410ad80b1">ResetPosition</a> (const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;gyroAngle, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_position.html">SwerveModulePosition</a>, NumModules &gt; &amp;modulePositions, const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;pose)</td></tr>
<tr class="memdesc:a5d9c637e4ec9b0a7d5f74f7410ad80b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the robot's position on the field.  <a href="classfrc_1_1_swerve_drive_pose_estimator.html#a5d9c637e4ec9b0a7d5f74f7410ad80b1">More...</a><br /></td></tr>
<tr class="separator:a5d9c637e4ec9b0a7d5f74f7410ad80b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa43500d257dd6e01c810ffd6992e2a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#afa43500d257dd6e01c810ffd6992e2a9">GetEstimatedPosition</a> () const</td></tr>
<tr class="memdesc:afa43500d257dd6e01c810ffd6992e2a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the pose of the robot at the current time as estimated by the Extended Kalman Filter.  <a href="classfrc_1_1_swerve_drive_pose_estimator.html#afa43500d257dd6e01c810ffd6992e2a9">More...</a><br /></td></tr>
<tr class="separator:afa43500d257dd6e01c810ffd6992e2a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa839fb27ac13f391e5f9314e154b8f51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#aa839fb27ac13f391e5f9314e154b8f51">SetVisionMeasurementStdDevs</a> (const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;visionMeasurementStdDevs)</td></tr>
<tr class="memdesc:aa839fb27ac13f391e5f9314e154b8f51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the pose estimator's trust of global measurements.  <a href="classfrc_1_1_swerve_drive_pose_estimator.html#aa839fb27ac13f391e5f9314e154b8f51">More...</a><br /></td></tr>
<tr class="separator:aa839fb27ac13f391e5f9314e154b8f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2ad6ac96725e2e2732032d9fdcdc5d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#af2ad6ac96725e2e2732032d9fdcdc5d7">AddVisionMeasurement</a> (const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;visionRobotPose, units::second_t timestamp)</td></tr>
<tr class="memdesc:af2ad6ac96725e2e2732032d9fdcdc5d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a vision measurement to the Unscented Kalman Filter.  <a href="classfrc_1_1_swerve_drive_pose_estimator.html#af2ad6ac96725e2e2732032d9fdcdc5d7">More...</a><br /></td></tr>
<tr class="separator:af2ad6ac96725e2e2732032d9fdcdc5d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b964991242b8c03fc9010cc8001b5b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a0b964991242b8c03fc9010cc8001b5b8">AddVisionMeasurement</a> (const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;visionRobotPose, units::second_t timestamp, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;visionMeasurementStdDevs)</td></tr>
<tr class="memdesc:a0b964991242b8c03fc9010cc8001b5b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a vision measurement to the Unscented Kalman Filter.  <a href="classfrc_1_1_swerve_drive_pose_estimator.html#a0b964991242b8c03fc9010cc8001b5b8">More...</a><br /></td></tr>
<tr class="separator:a0b964991242b8c03fc9010cc8001b5b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99a1e8803e8ac95db3d924df1c9f13ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a99a1e8803e8ac95db3d924df1c9f13ea">Update</a> (const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;gyroAngle, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_state.html">SwerveModuleState</a>, NumModules &gt; &amp;moduleStates, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_position.html">SwerveModulePosition</a>, NumModules &gt; &amp;modulePositions)</td></tr>
<tr class="memdesc:a99a1e8803e8ac95db3d924df1c9f13ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the the Unscented Kalman Filter using only wheel encoder information.  <a href="classfrc_1_1_swerve_drive_pose_estimator.html#a99a1e8803e8ac95db3d924df1c9f13ea">More...</a><br /></td></tr>
<tr class="separator:a99a1e8803e8ac95db3d924df1c9f13ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d9975972f6e890adf808f4002d6343c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a7d9975972f6e890adf808f4002d6343c">UpdateWithTime</a> (units::second_t currentTime, const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;gyroAngle, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_state.html">SwerveModuleState</a>, NumModules &gt; &amp;moduleStates, const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_position.html">SwerveModulePosition</a>, NumModules &gt; &amp;modulePositions)</td></tr>
<tr class="memdesc:a7d9975972f6e890adf808f4002d6343c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the the Unscented Kalman Filter using only wheel encoder information.  <a href="classfrc_1_1_swerve_drive_pose_estimator.html#a7d9975972f6e890adf808f4002d6343c">More...</a><br /></td></tr>
<tr class="separator:a7d9975972f6e890adf808f4002d6343c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:ac8964f855367a4f027a26d871f13965b"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#ac8964f855367a4f027a26d871f13965b">States</a> = 3 + NumModules</td></tr>
<tr class="separator:ac8964f855367a4f027a26d871f13965b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4430f83e78f77ebf49b1ae1861e6c8c"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#ae4430f83e78f77ebf49b1ae1861e6c8c">Inputs</a> = 3 + NumModules</td></tr>
<tr class="separator:ae4430f83e78f77ebf49b1ae1861e6c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9142b8f6585f7102eaffceaba1df8c0d"><td class="memItemLeft" align="right" valign="top">static constexpr size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a9142b8f6585f7102eaffceaba1df8c0d">Outputs</a> = 1 + NumModules</td></tr>
<tr class="separator:a9142b8f6585f7102eaffceaba1df8c0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;size_t NumModules&gt;<br />
class frc::SwerveDrivePoseEstimator&lt; NumModules &gt;</div><p >This class wraps an Unscented Kalman Filter to fuse latency-compensated vision measurements with swerve drive encoder velocity measurements. </p>
<p >It will correct for noisy measurements and encoder drift. It is intended to be an easy but more accurate drop-in for <a class="el" href="classfrc_1_1_swerve_drive_odometry.html" title="Class for swerve drive odometry.">SwerveDriveOdometry</a>.</p>
<p ><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a99a1e8803e8ac95db3d924df1c9f13ea" title="Updates the the Unscented Kalman Filter using only wheel encoder information.">Update()</a> should be called every robot loop. If your loops are faster or slower than the default of 20 ms, then you should change the nominal delta time by specifying it in the constructor.</p>
<p ><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#af2ad6ac96725e2e2732032d9fdcdc5d7" title="Add a vision measurement to the Unscented Kalman Filter.">AddVisionMeasurement()</a> can be called as infrequently as you want; if you never call it, then this class will behave mostly like regular encoder odometry.</p>
<p >The state-space system used internally has the following states (x), inputs (u), and outputs (y):</p>
<p ><b> x = [x, y, theta, s_0, ..., s_n]ᵀ </b> in the field coordinate system containing x position, y position, and heading, followed by the distance travelled by each wheel.</p>
<p ><b> u = [v_x, v_y, omega, v_0, ... v_n]ᵀ </b> containing x velocity, y velocity, and angular velocity in the field coordinate system, followed by the velocity measured at each wheel.</p>
<p ><b> y = [x, y, theta]ᵀ </b> from vision containing x position, y position, and heading; or <b> y = [theta, s_0, ..., s_n]ᵀ </b> containing gyro heading, followed by the distance travelled by each wheel. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a897055b71e6be4167bef1c47db5f0254" name="a897055b71e6be4167bef1c47db5f0254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a897055b71e6be4167bef1c47db5f0254">&#9670;&nbsp;</a></span>SwerveDrivePoseEstimator()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::SwerveDrivePoseEstimator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;&#160;</td>
          <td class="paramname"><em>gyroAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_position.html">SwerveModulePosition</a>, NumModules &gt; &amp;&#160;</td>
          <td class="paramname"><em>modulePositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;&#160;</td>
          <td class="paramname"><em>initialPose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfrc_1_1_swerve_drive_kinematics.html">SwerveDriveKinematics</a>&lt; NumModules &gt; &amp;&#160;</td>
          <td class="paramname"><em>kinematics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#ac8964f855367a4f027a26d871f13965b">States</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>stateStdDevs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a9142b8f6585f7102eaffceaba1df8c0d">Outputs</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>localMeasurementStdDevs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>visionMeasurementStdDevs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::second_t&#160;</td>
          <td class="paramname"><em>nominalDt</em> = <code>20_ms</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html" title="This class wraps an Unscented Kalman Filter to fuse latency-compensated vision measurements with swer...">SwerveDrivePoseEstimator</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
    <tr><td class="paramname">modulePositions</td><td>The current distance and rotation measurements of the swerve modules. </td></tr>
    <tr><td class="paramname">initialPose</td><td>The starting pose estimate. </td></tr>
    <tr><td class="paramname">kinematics</td><td>A correctly-configured kinematics object for your drivetrain. </td></tr>
    <tr><td class="paramname">stateStdDevs</td><td>Standard deviations of model states. Increase these numbers to trust your model's state estimates less. This matrix is in the form [x, y, theta, s_0, ... s_n]ᵀ, with units in meters and radians, then meters. </td></tr>
    <tr><td class="paramname">localMeasurementStdDevs</td><td>Standard deviation of the gyro measurement. Increase this number to trust sensor readings from the gyro less. This matrix is in the form [theta, s_0, ... s_n], with units in radians followed by meters. </td></tr>
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision measurements. Increase these numbers to trust global measurements from vision less. This matrix is in the form [x, y, theta]ᵀ, with units in meters and radians. </td></tr>
    <tr><td class="paramname">nominalDt</td><td>The time in seconds between each robot loop. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af2ad6ac96725e2e2732032d9fdcdc5d7" name="af2ad6ac96725e2e2732032d9fdcdc5d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2ad6ac96725e2e2732032d9fdcdc5d7">&#9670;&nbsp;</a></span>AddVisionMeasurement() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::AddVisionMeasurement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;&#160;</td>
          <td class="paramname"><em>visionRobotPose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::second_t&#160;</td>
          <td class="paramname"><em>timestamp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a vision measurement to the Unscented Kalman Filter. </p>
<p >This will correct the odometry pose estimate while still accounting for measurement noise.</p>
<p >This method can be called as infrequently as you want, as long as you are calling <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a99a1e8803e8ac95db3d924df1c9f13ea" title="Updates the the Unscented Kalman Filter using only wheel encoder information.">Update()</a> every loop.</p>
<p >To promote stability of the pose estimate and make it robust to bad vision data, we recommend only adding vision measurements that are already within one meter or so of the current pose estimate.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionRobotPose</td><td>The pose of the robot as measured by the vision camera. </td></tr>
    <tr><td class="paramname">timestamp</td><td>The timestamp of the vision measurement in seconds. Note that if you don't use your own time source by calling <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a7d9975972f6e890adf808f4002d6343c" title="Updates the the Unscented Kalman Filter using only wheel encoder information.">UpdateWithTime()</a> then you must use a timestamp with an epoch since FPGA startup (i.e. the epoch of this timestamp is the same epoch as <a class="el" href="classfrc_1_1_timer.html#a1a0b1c162a033bbf4d7053eee550745c" title="Return the FPGA system clock time in seconds.">Timer::GetFPGATimestamp</a>.) This means that you should use <a class="el" href="classfrc_1_1_timer.html#a1a0b1c162a033bbf4d7053eee550745c" title="Return the FPGA system clock time in seconds.">Timer::GetFPGATimestamp</a> as your time source or sync the epochs. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0b964991242b8c03fc9010cc8001b5b8" name="a0b964991242b8c03fc9010cc8001b5b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b964991242b8c03fc9010cc8001b5b8">&#9670;&nbsp;</a></span>AddVisionMeasurement() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::AddVisionMeasurement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;&#160;</td>
          <td class="paramname"><em>visionRobotPose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">units::second_t&#160;</td>
          <td class="paramname"><em>timestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>visionMeasurementStdDevs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a vision measurement to the Unscented Kalman Filter. </p>
<p >This will correct the odometry pose estimate while still accounting for measurement noise.</p>
<p >This method can be called as infrequently as you want, as long as you are calling <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a99a1e8803e8ac95db3d924df1c9f13ea" title="Updates the the Unscented Kalman Filter using only wheel encoder information.">Update()</a> every loop.</p>
<p >To promote stability of the pose estimate and make it robust to bad vision data, we recommend only adding vision measurements that are already within one meter or so of the current pose estimate.</p>
<p >Note that the vision measurement standard deviations passed into this method will continue to apply to future measurements until a subsequent call to <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#aa839fb27ac13f391e5f9314e154b8f51" title="Sets the pose estimator&#39;s trust of global measurements.">SetVisionMeasurementStdDevs()</a> or this method.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionRobotPose</td><td>The pose of the robot as measured by the vision camera. </td></tr>
    <tr><td class="paramname">timestamp</td><td>The timestamp of the vision measurement in seconds. Note that if you don't use your own time source by calling <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html#a7d9975972f6e890adf808f4002d6343c" title="Updates the the Unscented Kalman Filter using only wheel encoder information.">UpdateWithTime()</a>, then you must use a timestamp with an epoch since FPGA startup (i.e. the epoch of this timestamp is the same epoch as <a class="el" href="classfrc_1_1_timer.html#a1a0b1c162a033bbf4d7053eee550745c" title="Return the FPGA system clock time in seconds.">frc::Timer::GetFPGATimestamp()</a>. This means that you should use <a class="el" href="classfrc_1_1_timer.html#a1a0b1c162a033bbf4d7053eee550745c" title="Return the FPGA system clock time in seconds.">frc::Timer::GetFPGATimestamp()</a> as your time source in this case. </td></tr>
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision measurements. Increase these numbers to trust global measurements from vision less. This matrix is in the form [x, y, theta]ᵀ, with units in meters and radians. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afa43500d257dd6e01c810ffd6992e2a9" name="afa43500d257dd6e01c810ffd6992e2a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa43500d257dd6e01c810ffd6992e2a9">&#9670;&nbsp;</a></span>GetEstimatedPosition()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::GetEstimatedPosition </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the pose of the robot at the current time as estimated by the Extended Kalman Filter. </p>
<dl class="section return"><dt>Returns</dt><dd>The estimated robot pose in meters. </dd></dl>

</div>
</div>
<a id="a5d9c637e4ec9b0a7d5f74f7410ad80b1" name="a5d9c637e4ec9b0a7d5f74f7410ad80b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d9c637e4ec9b0a7d5f74f7410ad80b1">&#9670;&nbsp;</a></span>ResetPosition()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::ResetPosition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;&#160;</td>
          <td class="paramname"><em>gyroAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_position.html">SwerveModulePosition</a>, NumModules &gt; &amp;&#160;</td>
          <td class="paramname"><em>modulePositions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> &amp;&#160;</td>
          <td class="paramname"><em>pose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Resets the robot's position on the field. </p>
<p >IF leftDistance and rightDistance are unspecified, You NEED to reset your encoders (to zero).</p>
<p >The gyroscope angle does not need to be reset in the user's robot code. The library automatically takes care of offsetting the gyro angle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gyroAngle</td><td>The angle reported by the gyroscope. </td></tr>
    <tr><td class="paramname">modulePositions</td><td>The current distance and rotation measurements of the swerve modules. </td></tr>
    <tr><td class="paramname">pose</td><td>The position on the field that your robot is at. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa839fb27ac13f391e5f9314e154b8f51" name="aa839fb27ac13f391e5f9314e154b8f51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa839fb27ac13f391e5f9314e154b8f51">&#9670;&nbsp;</a></span>SetVisionMeasurementStdDevs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::SetVisionMeasurementStdDevs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; double, 3 &gt; &amp;&#160;</td>
          <td class="paramname"><em>visionMeasurementStdDevs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the pose estimator's trust of global measurements. </p>
<p >This might be used to change trust in vision measurements after the autonomous period, or to change trust as distance to a vision target increases.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">visionMeasurementStdDevs</td><td>Standard deviations of the vision measurements. Increase these numbers to trust global measurements from vision less. This matrix is in the form [x, y, theta]ᵀ, with units in meters and radians. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a99a1e8803e8ac95db3d924df1c9f13ea" name="a99a1e8803e8ac95db3d924df1c9f13ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99a1e8803e8ac95db3d924df1c9f13ea">&#9670;&nbsp;</a></span>Update()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::Update </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;&#160;</td>
          <td class="paramname"><em>gyroAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_state.html">SwerveModuleState</a>, NumModules &gt; &amp;&#160;</td>
          <td class="paramname"><em>moduleStates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_position.html">SwerveModulePosition</a>, NumModules &gt; &amp;&#160;</td>
          <td class="paramname"><em>modulePositions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates the the Unscented Kalman Filter using only wheel encoder information. </p>
<p >This should be called every loop, and the correct loop period must be passed into the constructor of this class.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
    <tr><td class="paramname">moduleStates</td><td>The current velocities and rotations of the swerve modules. </td></tr>
    <tr><td class="paramname">modulePositions</td><td>The current distance and rotation measurements of the swerve modules. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The estimated pose of the robot in meters. </dd></dl>

</div>
</div>
<a id="a7d9975972f6e890adf808f4002d6343c" name="a7d9975972f6e890adf808f4002d6343c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d9975972f6e890adf808f4002d6343c">&#9670;&nbsp;</a></span>UpdateWithTime()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classfrc_1_1_pose2d.html">Pose2d</a> <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::UpdateWithTime </td>
          <td>(</td>
          <td class="paramtype">units::second_t&#160;</td>
          <td class="paramname"><em>currentTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfrc_1_1_rotation2d.html">Rotation2d</a> &amp;&#160;</td>
          <td class="paramname"><em>gyroAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_state.html">SwerveModuleState</a>, NumModules &gt; &amp;&#160;</td>
          <td class="paramname"><em>moduleStates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classwpi_1_1array.html">wpi::array</a>&lt; <a class="el" href="structfrc_1_1_swerve_module_position.html">SwerveModulePosition</a>, NumModules &gt; &amp;&#160;</td>
          <td class="paramname"><em>modulePositions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates the the Unscented Kalman Filter using only wheel encoder information. </p>
<p >This should be called every loop, and the correct loop period must be passed into the constructor of this class.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">currentTime</td><td>Time at which this method was called, in seconds. </td></tr>
    <tr><td class="paramname">gyroAngle</td><td>The current gyro angle. </td></tr>
    <tr><td class="paramname">moduleStates</td><td>The current velocities and rotations of the swerve modules. </td></tr>
    <tr><td class="paramname">modulePositions</td><td>The current distance travelled and rotations of the swerve modules. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The estimated pose of the robot in meters. </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae4430f83e78f77ebf49b1ae1861e6c8c" name="ae4430f83e78f77ebf49b1ae1861e6c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4430f83e78f77ebf49b1ae1861e6c8c">&#9670;&nbsp;</a></span>Inputs</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::Inputs = 3 + NumModules</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a9142b8f6585f7102eaffceaba1df8c0d" name="a9142b8f6585f7102eaffceaba1df8c0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9142b8f6585f7102eaffceaba1df8c0d">&#9670;&nbsp;</a></span>Outputs</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::Outputs = 1 + NumModules</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac8964f855367a4f027a26d871f13965b" name="ac8964f855367a4f027a26d871f13965b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8964f855367a4f027a26d871f13965b">&#9670;&nbsp;</a></span>States</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;size_t NumModules&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr size_t <a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">frc::SwerveDrivePoseEstimator</a>&lt; NumModules &gt;::States = 3 + NumModules</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>frc/estimator/<a class="el" href="_swerve_drive_pose_estimator_8h_source.html">SwerveDrivePoseEstimator.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefrc.html">frc</a></li><li class="navelem"><a class="el" href="classfrc_1_1_swerve_drive_pose_estimator.html">SwerveDrivePoseEstimator</a></li>
    <li class="footer">Generated on Sun Nov 27 2022 01:05:24 for WPILibC++ by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
